 Celery beat not working after upgrading to django 3.0.5
 error traceback - 

[2020-05-01 07:37:48,332: WARNING/MainProcess] Traceback (most recent call last):
[2020-05-01 07:37:48,333: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/kombu/utils/objects.py", line 42, in __get__
[2020-05-01 07:37:48,333: WARNING/MainProcess] return obj.__dict__[self.__name__]
[2020-05-01 07:37:48,333: WARNING/MainProcess] KeyError
[2020-05-01 07:37:48,333: WARNING/MainProcess] :
[2020-05-01 07:37:48,333: WARNING/MainProcess] 'scheduler'
[2020-05-01 07:37:48,333: WARNING/MainProcess] During handling of the above exception, another exception occurred:
[2020-05-01 07:37:48,333: WARNING/MainProcess] Traceback (most recent call last):
[2020-05-01 07:37:48,334: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/bin/celery", line 10, in <module>
[2020-05-01 07:37:48,334: WARNING/MainProcess] sys.exit(main())
[2020-05-01 07:37:48,334: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/celery/__main__.py", line 16, in main
[2020-05-01 07:37:48,334: WARNING/MainProcess] _main()
[2020-05-01 07:37:48,334: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/celery/bin/celery.py", line 322, in main
[2020-05-01 07:37:48,334: WARNING/MainProcess] cmd.execute_from_commandline(argv)
[2020-05-01 07:37:48,334: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/celery/bin/celery.py", line 495, in execute_from_commandline
[2020-05-01 07:37:48,335: WARNING/MainProcess] super(CeleryCommand, self).execute_from_commandline(argv)))
[2020-05-01 07:37:48,335: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/celery/bin/base.py", line 305, in execute_from_commandline
[2020-05-01 07:37:48,335: WARNING/MainProcess] return self.handle_argv(self.prog_name, argv[1:])
[2020-05-01 07:37:48,335: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/celery/bin/celery.py", line 487, in handle_argv
[2020-05-01 07:37:48,336: WARNING/MainProcess] return self.execute(command, argv)
[2020-05-01 07:37:48,336: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/celery/bin/celery.py", line 419, in execute
[2020-05-01 07:37:48,336: WARNING/MainProcess] ).run_from_argv(self.prog_name, argv[1:], command=argv[0])
[2020-05-01 07:37:48,336: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/celery/bin/base.py", line 309, in run_from_argv
[2020-05-01 07:37:48,336: WARNING/MainProcess] sys.argv if argv is None else argv, command)
[2020-05-01 07:37:48,336: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/celery/bin/base.py", line 393, in handle_argv
[2020-05-01 07:37:48,337: WARNING/MainProcess] return self(*args, **options)
[2020-05-01 07:37:48,337: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/celery/bin/base.py", line 253, in __call__
[2020-05-01 07:37:48,337: WARNING/MainProcess] ret = self.run(*args, **kwargs)
[2020-05-01 07:37:48,337: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/celery/bin/beat.py", line 109, in run
[2020-05-01 07:37:48,337: WARNING/MainProcess] return beat().run()
[2020-05-01 07:37:48,337: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/celery/apps/beat.py", line 81, in run
[2020-05-01 07:37:48,337: WARNING/MainProcess] self.start_scheduler()
[2020-05-01 07:37:48,338: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/celery/apps/beat.py", line 109, in start_scheduler
[2020-05-01 07:37:48,338: WARNING/MainProcess] service.start()
[2020-05-01 07:37:48,338: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/celery/beat.py", line 622, in start
[2020-05-01 07:37:48,338: WARNING/MainProcess] humanize_seconds(self.scheduler.max_interval))
[2020-05-01 07:37:48,338: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/kombu/utils/objects.py", line 44, in __get__
[2020-05-01 07:37:48,338: WARNING/MainProcess] value = obj.__dict__[self.__name__] = self.__get(obj)
[2020-05-01 07:37:48,339: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/celery/beat.py", line 666, in scheduler
[2020-05-01 07:37:48,339: WARNING/MainProcess] return self.get_scheduler()
[2020-05-01 07:37:48,339: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/celery/beat.py", line 661, in get_scheduler
[2020-05-01 07:37:48,339: WARNING/MainProcess] lazy=lazy,
[2020-05-01 07:37:48,340: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/djcelery/schedulers.py", line 161, in __init__
[2020-05-01 07:37:48,340: WARNING/MainProcess] Scheduler.__init__(self, *args, **kwargs)
[2020-05-01 07:37:48,340: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/celery/beat.py", line 257, in __init__
[2020-05-01 07:37:48,340: WARNING/MainProcess] self.setup_schedule()
[2020-05-01 07:37:48,340: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/djcelery/schedulers.py", line 169, in setup_schedule
[2020-05-01 07:37:48,341: WARNING/MainProcess] self.install_default_entries(self.schedule)
[2020-05-01 07:37:48,341: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/djcelery/schedulers.py", line 263, in schedule
[2020-05-01 07:37:48,341: WARNING/MainProcess] self.sync()
[2020-05-01 07:37:48,341: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/djcelery/schedulers.py", line 217, in sync
[2020-05-01 07:37:48,341: WARNING/MainProcess] with commit_on_success():
[2020-05-01 07:37:48,341: WARNING/MainProcess] File "/usr/lib/python3.6/contextlib.py", line 81, in __enter__
[2020-05-01 07:37:48,341: WARNING/MainProcess] return next(self.gen)
[2020-05-01 07:37:48,341: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/djcelery/db.py", line 52, in commit_on_success
[2020-05-01 07:37:48,341: WARNING/MainProcess] if connection.features.autocommits_when_autocommit_is_off:
[2020-05-01 07:37:48,341: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/django/contrib/gis/db/backends/base/features.py", line 99, in __getattr__
[2020-05-01 07:37:48,342: WARNING/MainProcess] raise AttributeError
[2020-05-01 07:37:48,342: WARNING/MainProcess] AttributeError
[2020-05-01 07:37:48,342: INFO/MainProcess] Writing entries (0)...
[2020-05-01 07:37:48,343: WARNING/MainProcess] Traceback (most recent call last):
[2020-05-01 07:37:48,343: WARNING/MainProcess] File "/usr/lib/python3.6/multiprocessing/util.py", line 262, in _run_finalizers
    finalizer()
[2020-05-01 07:37:48,343: WARNING/MainProcess] File "/usr/lib/python3.6/multiprocessing/util.py", line 186, in __call__
    res = self._callback(*self._args, **self._kwargs)
[2020-05-01 07:37:48,343: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/djcelery/schedulers.py", line 217, in sync
    with commit_on_success():
[2020-05-01 07:37:48,343: WARNING/MainProcess] File "/usr/lib/python3.6/contextlib.py", line 81, in __enter__
    return next(self.gen)
[2020-05-01 07:37:48,343: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/djcelery/db.py", line 52, in commit_on_success
    if connection.features.autocommits_when_autocommit_is_off:
[2020-05-01 07:37:48,343: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/django/contrib/gis/db/backends/base/features.py", line 99, in __getattr__
    raise AttributeError
[2020-05-01 07:37:48,343: WARNING/MainProcess] AttributeError
[2020-05-01 07:37:48,343: INFO/MainProcess] Writing entries (0)...
[2020-05-01 07:37:48,343: WARNING/MainProcess] Traceback (most recent call last):
[2020-05-01 07:37:48,343: WARNING/MainProcess] File "/usr/lib/python3.6/multiprocessing/util.py", line 262, in _run_finalizers
    finalizer()
[2020-05-01 07:37:48,344: WARNING/MainProcess] File "/usr/lib/python3.6/multiprocessing/util.py", line 186, in __call__
    res = self._callback(*self._args, **self._kwargs)
[2020-05-01 07:37:48,344: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/djcelery/schedulers.py", line 217, in sync
    with commit_on_success():
[2020-05-01 07:37:48,344: WARNING/MainProcess] File "/usr/lib/python3.6/contextlib.py", line 81, in __enter__
    return next(self.gen)
[2020-05-01 07:37:48,344: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/djcelery/db.py", line 52, in commit_on_success
    if connection.features.autocommits_when_autocommit_is_off:
[2020-05-01 07:37:48,344: WARNING/MainProcess] File "/home/shivam/tmq1/venv2/lib/python3.6/site-packages/django/contrib/gis/db/backends/base/features.py", line 99, in __getattr__
    raise AttributeError
[2020-05-01 07:37:48,344: WARNING/MainProcess] AttributeError
 ’python manage.py celery beat‘ error
 ```
root@bdfb20f1b9a1:/workspace/backend# python manage.py celery beat
celery beat v3.1.15 (Cipater) is starting.
__    -    ... __   -        _
Configuration ->
    . broker -> redis://mysite-redis:6379/2
    . loader -> djcelery.loaders.DjangoLoader
    . scheduler -> djcelery.schedulers.DatabaseScheduler

    . logfile -> [stderr]@%INFO
    . maxinterval -> now (0s)
[2020-04-08 09:22:24,901: INFO/MainProcess] beat: Starting...
[2020-04-08 09:22:24,901: INFO/MainProcess] Writing entries (0)...
[2020-04-08 09:22:24,901: CRITICAL/MainProcess] beat raised exception <class 'AttributeError'>: AttributeError("'DatabaseFeatures' object has no attribute 'autocommits_when_autocommit_is_off'",)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/kombu/utils/__init__.py", line 323, in __get__
    return obj.__dict__[self.__name__]
KeyError: 'scheduler'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/celery/apps/beat.py", line 112, in start_scheduler
    beat.start()
  File "/usr/local/lib/python3.6/site-packages/celery/beat.py", line 453, in start
    humanize_seconds(self.scheduler.max_interval))
  File "/usr/local/lib/python3.6/site-packages/kombu/utils/__init__.py", line 325, in __get__
    value = obj.__dict__[self.__name__] = self.__get(obj)
  File "/usr/local/lib/python3.6/site-packages/celery/beat.py", line 493, in scheduler
    return self.get_scheduler()
  File "/usr/local/lib/python3.6/site-packages/celery/beat.py", line 488, in get_scheduler
    lazy=lazy)
  File "/usr/local/lib/python3.6/site-packages/celery/utils/imports.py", line 53, in instantiate
    return symbol_by_name(name)(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/djcelery/schedulers.py", line 161, in __init__
    Scheduler.__init__(self, *args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/celery/beat.py", line 184, in __init__
    self.setup_schedule()
  File "/usr/local/lib/python3.6/site-packages/djcelery/schedulers.py", line 169, in setup_schedule
    self.install_default_entries(self.schedule)
  File "/usr/local/lib/python3.6/site-packages/djcelery/schedulers.py", line 263, in schedule
    self.sync()
  File "/usr/local/lib/python3.6/site-packages/djcelery/schedulers.py", line 217, in sync
    with commit_on_success():
  File "/usr/local/lib/python3.6/contextlib.py", line 81, in __enter__
    return next(self.gen)
  File "/usr/local/lib/python3.6/site-packages/djcelery/db.py", line 52, in commit_on_success
    if connection.features.autocommits_when_autocommit_is_off:
AttributeError: 'DatabaseFeatures' object has no attribute 'autocommits_when_autocommit_is_off'
[2020-04-08 09:22:24,902: INFO/MainProcess] Writing entries (0)...
[2020-04-08 09:22:24,903: WARNING/MainProcess] Traceback (most recent call last):
[2020-04-08 09:22:24,903: WARNING/MainProcess] File "/usr/local/lib/python3.6/multiprocessing/util.py", line 262, in _run_finalizers
    finalizer()
[2020-04-08 09:22:24,903: WARNING/MainProcess] File "/usr/local/lib/python3.6/multiprocessing/util.py", line 186, in __call__
    res = self._callback(*self._args, **self._kwargs)
[2020-04-08 09:22:24,903: WARNING/MainProcess] File "/usr/local/lib/python3.6/site-packages/djcelery/schedulers.py", line 217, in sync
    with commit_on_success():
[2020-04-08 09:22:24,903: WARNING/MainProcess] File "/usr/local/lib/python3.6/contextlib.py", line 81, in __enter__
    return next(self.gen)
[2020-04-08 09:22:24,903: WARNING/MainProcess] File "/usr/local/lib/python3.6/site-packages/djcelery/db.py", line 52, in commit_on_success
    if connection.features.autocommits_when_autocommit_is_off:
[2020-04-08 09:22:24,903: WARNING/MainProcess] AttributeError: 'DatabaseFeatures' object has no attribute 'autocommits_when_autocommit_is_off'
[2020-04-08 09:22:24,903: INFO/MainProcess] Writing entries (0)...
[2020-04-08 09:22:24,903: WARNING/MainProcess] Traceback (most recent call last):
[2020-04-08 09:22:24,904: WARNING/MainProcess] File "/usr/local/lib/python3.6/multiprocessing/util.py", line 262, in _run_finalizers
    finalizer()
[2020-04-08 09:22:24,904: WARNING/MainProcess] File "/usr/local/lib/python3.6/multiprocessing/util.py", line 186, in __call__
    res = self._callback(*self._args, **self._kwargs)
[2020-04-08 09:22:24,904: WARNING/MainProcess] File "/usr/local/lib/python3.6/site-packages/djcelery/schedulers.py", line 217, in sync
    with commit_on_success():
[2020-04-08 09:22:24,904: WARNING/MainProcess] File "/usr/local/lib/python3.6/contextlib.py", line 81, in __enter__
    return next(self.gen)
[2020-04-08 09:22:24,904: WARNING/MainProcess] File "/usr/local/lib/python3.6/site-packages/djcelery/db.py", line 52, in commit_on_success
    if connection.features.autocommits_when_autocommit_is_off:
[2020-04-08 09:22:24,904: WARNING/MainProcess] AttributeError: 'DatabaseFeatures' object has no attribute 'autocommits_when_autocommit_is_off'

```

## env
```
amqp==1.4.9
anyjson==0.3.3
asgiref==3.2.7
backcall==0.1.0
billiard==3.3.0.23
captcha==0.3
celery==3.1.15
celery-with-redis==3.0
certifi==2020.4.5.1
chardet==3.0.4
coreapi==2.3.3
coreschema==0.0.4
cycler==0.10.0
decorator==4.4.2
Django==3.0.4
django-celery==3.3.1
django-filter==2.2.0
django-redis==4.11.0
django-rest-swagger==2.2.0
djangorestframework==3.11.0
flower==0.9.4
gevent==1.4.0
greenlet==0.4.15
gunicorn==20.0.4
humanize==0.5.1
idna==2.9
ipython==6.5.0
ipython-genutils==0.2.0
itypes==1.1.0
jedi==0.16.0
Jinja2==2.11.1
kiwisolver==1.2.0
kombu==3.0.37
Markdown==3.2.1
MarkupSafe==1.1.1
matplotlib==3.2.0
numpy==1.18.2
openapi-codec==1.3.2
parso==0.6.2
pexpect==4.8.0
pickleshare==0.7.5
Pillow==7.1.1
prompt-toolkit==1.0.18
psycopg2==2.8.4
ptyprocess==0.6.0
Pygments==2.6.1
PyJWT==1.7.1
pyparsing==2.4.7
python-dateutil==2.8.1
pytz==2019.3
redis==3.4.1
requests==2.23.0
simplegeneric==0.8.1
simplejson==3.17.0
six==1.14.0
sqlparse==0.3.1
supervisor==4.1.0
tornado==6.0.4
traitlets==4.3.3
tzlocal==2.0.0
uritemplate==3.0.1
urllib3==1.25.8
wcwidth==0.1.9

```
 The python3.7.5 keyword async conflicts with celery3.1.26.post2 django-celery3.2.2
 celery beat v3.1.26.post2 (Cipater) is starting.
Traceback (most recent call last):
  File "manage.py", line 21, in <module>
    main()
  File "manage.py", line 17, in main
    execute_from_command_line(sys.argv)
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/django/core/management/__init__.py", line 381, in execute_from_command_line
    utility.execute()
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/django/core/management/__init__.py", line 375, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/djcelery/management/commands/celery.py", line 21, in run_from_argv
    ['{0[0]} {0[1]}'.format(argv)] + argv[2:],
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/celery/bin/celery.py", line 793, in execute_from_commandline
    super(CeleryCommand, self).execute_from_commandline(argv)))
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/celery/bin/base.py", line 311, in execute_from_commandline
    return self.handle_argv(self.prog_name, argv[1:])
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/celery/bin/celery.py", line 785, in handle_argv
    return self.execute(command, argv)
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/celery/bin/celery.py", line 717, in execute
    ).run_from_argv(self.prog_name, argv[1:], command=argv[0])
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/celery/bin/base.py", line 315, in run_from_argv
    sys.argv if argv is None else argv, command)
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/celery/bin/base.py", line 377, in handle_argv
    return self(*args, **options)
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/celery/bin/base.py", line 274, in __call__
    ret = self.run(*args, **kwargs)
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/celery/bin/beat.py", line 79, in run
    return beat().run()
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/celery/apps/beat.py", line 83, in run
    self.start_scheduler()
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/celery/apps/beat.py", line 104, in start_scheduler
    c.reset(self.startup_info(beat)))))
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/celery/apps/beat.py", line 127, in startup_info
    conninfo=self.app.connection().as_uri(),
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/celery/app/base.py", line 386, in connection
    'BROKER_CONNECTION_TIMEOUT', connect_timeout
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/kombu/connection.py", line 177, in __init__
    if not get_transport_cls(transport).can_parse_url:
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/kombu/transport/__init__.py", line 109, in get_transport_cls
    _transport_cache[transport] = resolve_transport(transport)
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/kombu/transport/__init__.py", line 93, in resolve_transport
    return symbol_by_name(transport)
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/kombu/utils/__init__.py", line 96, in symbol_by_name
    module = imp(module_name, package=package, **kwargs)
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1006, in _gcd_import
  File "<frozen importlib._bootstrap>", line 983, in _find_and_load
  File "<frozen importlib._bootstrap>", line 967, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 677, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 724, in exec_module
  File "<frozen importlib._bootstrap_external>", line 860, in get_code
  File "<frozen importlib._bootstrap_external>", line 791, in source_to_code
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/Users/nts/VirtualenvWrapper/cmdb/lib/python3.7/site-packages/kombu/transport/redis.py", line 815
    def _connparams(self, async=False, _r210_options=(
                              ^
SyntaxError: invalid syntax
 AttributeError: 'DatabaseFeatures' object has no attribute 'autocommits_when_autocommit_is_off'
 
celery-beat_1  |   File "/usr/local/lib/python3.8/site-packages/djcelery/schedulers.py", line 169, in setup_schedule
celery-beat_1  |     self.install_default_entries(self.schedule)
celery-beat_1  |   File "/usr/local/lib/python3.8/site-packages/djcelery/schedulers.py", line 263, in schedule
celery-beat_1  |     self.sync()
celery-beat_1  |   File "/usr/local/lib/python3.8/site-packages/djcelery/schedulers.py", line 217, in sync
celery-beat_1  |     with commit_on_success():
celery-beat_1  |   File "/usr/local/lib/python3.8/contextlib.py", line 113, in __enter__
celery-beat_1  |     return next(self.gen)
celery-beat_1  |   File "/usr/local/lib/python3.8/site-packages/djcelery/db.py", line 52, in commit_on_success
celery-beat_1  |     if connection.features.autocommits_when_autocommit_is_off:
celery-beat_1  | AttributeError: 'DatabaseFeatures' object has no attribute 'autocommits_when_autocommit_is_off'

I launch in docker, an error if I put the dependencies by default, if I put certain versions of the dependencies, then there is no error

the same error , is it has any solution?

i faced with the same issure,  it may be the issure with Django version, 

> the same error , is it has any solution?

i faced with the same issure,  it may be the issure with Django version, you can use the version (Django==2.1.8, celery 3.1.26.post2). it may be help you.

 django-celery can't use orm get the query set
 my task is using the django orm to get the datas, but if the data is new created, task always can't get it(query not exist, the true is it was created successed). but if i call the task in twice, the second time will be ok. I don't known why, may be I am stupid or I leave out something. my english is not so good, I expect you can understand what i say.
 django-celery use django orm can't get query set
 my task is using the django orm to get the datas, but if the data is new created, task always can't get it(query not exist, the true is it was created successed). but if i call the task in twice, the second time will be ok. I don't known why, may be I am stupid or I leave out something. my english is not so good, I expect you can understand what say.
 Change DatabaseScheduler.max_interval to match Celery's default Scheduler behaviour
 Fixes https://github.com/celery/django-celery/issues/590
 Change in behaviour of DatabaseScheduler.max_interval causing high CPU load for Celery beat
 Change in behaviour is introduced here:

https://github.com/celery/django-celery/commit/9866b6ba48fa859b36cf69b7cd0bb071a38371a8

Since `self.app.conf.CELERYBEAT_MAX_LOOP_INTERVAL` defaults to `0` (https://github.com/celery/celery/blob/c1171da3da4547a8a5048e52551d2c764def48f4/celery/app/defaults.py#L91), `self.max_interval` only uses `DEFAULT_MAX_INTERVAL` if `CELERYBEAT_MAX_LOOP_INTERVAL` is explicitly set to `None`. This change in behaviour caused our Celery beat to query the DB thousand times per second causing a high CPU load for Celery beat.

Celery's `Scheduler` is using how it was before:

https://github.com/celery/celery/blob/28e0e30d51fc2666a71918bb9d95de4c15dbe7a6/celery/beat.py#L247

I would opt for changing it back to how it was and how it currently is in Celery's `Scheduler`. Workaround for now is to explicitly set `CELERYBEAT_MAX_LOOP_INTERVAL` to for example the default value `5`.
 terminate only works for terminating parents task
 i have task with sub task. Every things is fine but when i terminate parent task, it only invoked parents task and doesn't effect for its child task. Is this is issue or I'm doing somethings wrongs
 Stop running task
 Can I use this package to start and stop task manually. 
 Adding Tidelift marketing text
 @auvipy as requested, here is the README marketing text
 Fix bug for adding a default value to celery.py when base.get_options return None
 You can see diff information.
<pre>
<--

diff --git a/djcelery/management/commands/celery.py b/djcelery/management/commands/celery.py
index 0ee878d..82cf303 100644
--- a/djcelery/management/commands/celery.py
+++ b/djcelery/management/commands/celery.py
@@ -13,7 +13,7 @@ class Command(CeleryCommand):
     help = 'celery commands, see celery help'
     options = (
         tuple(CeleryCommand.options) +
-        tuple(base.get_options()) +
+        tuple(base.get_options() or ()) +
         tuple(getattr(base, 'preload_options', ()))
     )

-->
</pre>
 TypeError: 'NoneType' object is not iterable
 Traceback (most recent call last):
  File "./manage.py", line 15, in <module>
    execute_from_command_line(sys.argv)
  File "/home/ubuntu/.virtualenvs/demo_for_djcelery/lib/python3.5/site-packages/django/core/management/__init__.py", line 381, in execute_from_command_line
    utility.execute()
  File "/home/ubuntu/.virtualenvs/demo_for_djcelery/lib/python3.5/site-packages/django/core/management/__init__.py", line 375, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/home/ubuntu/.virtualenvs/demo_for_djcelery/lib/python3.5/site-packages/django/core/management/__init__.py", line 224, in fetch_command
    klass = load_command_class(app_name, subcommand)
  File "/home/ubuntu/.virtualenvs/demo_for_djcelery/lib/python3.5/site-packages/django/core/management/__init__.py", line 36, in load_command_class
    module = import_module('%s.management.commands.%s' % (app_name, name))
  File "/home/ubuntu/.virtualenvs/demo_for_djcelery/lib/python3.5/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 985, in _gcd_import
  File "<frozen importlib._bootstrap>", line 968, in _find_and_load
  File "<frozen importlib._bootstrap>", line 957, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 673, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 697, in exec_module
  File "<frozen importlib._bootstrap>", line 222, in _call_with_frames_removed
  File "/home/ubuntu/.virtualenvs/demo_for_djcelery/lib/python3.5/site-packages/djcelery/management/commands/celery.py", line 11, in <module>
    class Command(CeleryCommand):
  File "/home/ubuntu/.virtualenvs/demo_for_djcelery/lib/python3.5/site-packages/djcelery/management/commands/celery.py", line 16, in Command
    tuple(base.get_options()) +
TypeError: 'NoneType' object is not iterable

===================================================================
Hello there, I got an error when I run command `./manage.py celery worker -l info -B` in django.

Here's the environment:

python: v3.5.5
celery: v4.3.0
djcelery: v3.3.1
redis: v3.3.11

how did you solve it?

i have got same problem.

Yes, it has been fixed before. 

You can see the commit here. https://github.com/celery/django-celery/commit/95c3953321cb25f5e75464d26e03832d3bb56d79

 TaskState is already registered
 Hi, when I try to migrate after add djcelery to my INTALLED_APPS I got this error.
Does anyone know why ? 

  File "C:\Users\Tartarotti\AppData\Local\Programs\Python\Python37-32\lib\site-packages\djcelery\admin.py", line 243, in <module>
    admin.site.register(TaskState, TaskMonitor)
  File "C:\Users\Tartarotti\AppData\Local\Programs\Python\Python37-32\lib\site-packages\django\contrib\admin\sites.py", line 109, in register
    raise AlreadyRegistered('The model %s is already registered' % model.__name__)
django.contrib.admin.sites.AlreadyRegistered: The model TaskState is already registered

 Fix typo in docs
 Just a small typo in the docs.
 ImportError: No module named timeutils
 Error Log
admin@AZ-P-MDC01:~$ sudo tail /var/log/apache2/error.log
[Sat Sep 21 07:40:42.155812 2019] [wsgi:error] [pid 32336:tid 140621097449216] [remote 105.63.190.146:58131]     self._populate()
[Sat Sep 21 07:40:42.155825 2019] [wsgi:error] [pid 32336:tid 140621097449216] [remote 105.63.190.146:58131]   File "/opt/formshare/lib/python2.7/site-packages/django/db/models/loading.py", line 78, in _populate
[Sat Sep 21 07:40:42.156087 2019] [wsgi:error] [pid 32336:tid 140621097449216] [remote 105.63.190.146:58131]     self.load_app(app_name)
[Sat Sep 21 07:40:42.156107 2019] [wsgi:error] [pid 32336:tid 140621097449216] [remote 105.63.190.146:58131]   File "/opt/formshare/lib/python2.7/site-packages/django/db/models/loading.py", line 99, in load_app
[Sat Sep 21 07:40:42.156121 2019] [wsgi:error] [pid 32336:tid 140621097449216] [remote 105.63.190.146:58131]     models = import_module('%s.models' % app_name)
[Sat Sep 21 07:40:42.156130 2019] [wsgi:error] [pid 32336:tid 140621097449216] [remote 105.63.190.146:58131]   File "/opt/formshare/lib/python2.7/site-packages/django/utils/importlib.py", line 40, in import_module
[Sat Sep 21 07:40:42.156142 2019] [wsgi:error] [pid 32336:tid 140621097449216] [remote 105.63.190.146:58131]     __import__(name)
[Sat Sep 21 07:40:42.156150 2019] [wsgi:error] [pid 32336:tid 140621097449216] [remote 105.63.190.146:58131]   File "/opt/formshare/lib/python2.7/site-packages/djcelery/models.py", line 15, in <module>
[Sat Sep 21 07:40:42.156257 2019] [wsgi:error] [pid 32336:tid 140621097449216] [remote 105.63.190.146:58131]     from celery.utils.timeutils import timedelta_seconds
[Sat Sep 21 07:40:42.156278 2019] [wsgi:error] [pid 32336:tid 140621097449216] [remote 105.63.190.146:58131] ImportError: No module named timeutils

Kindly advice on how to fix this would be highly appreciated. 
celery==3.1.23
django-celery==3.1.17
Ubuntu 18.04

Collins
No response

 issue #579. @@tx_isolation is deprecated since MYSQL 5.7.20, add mysq…
 issue #579. @@tx_isolation is deprecated since MYSQL 5.7.20, add correct version check
@liquidpele, could you please take a look. My previous code wasn't accurate. It didn't check mysql version correctly. I fixed it.

 issue #579. @@tx_isolation is deprecated since MYSQL 5.7.20
 `@@tx_isolation` is deprecated since MYSQL 5.7.20, we should use `@@transaction_isolation` instead
https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_tx_isolation

Fix suggested by [sqlalchemy](https://github.com/sqlalchemy/sqlalchemy/blob/rel_1_3/lib/sqlalchemy/dialects/mysql/base.py#L2193) realization 
 @@tx_isolation is deprecated since MYSQL 5.7.20
 `@@tx_isolation` is deprecated since MYSQL 5.7.20, we should use `@@transaction_isolation` instead
https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_tx_isolation
fixed

 Please upload v3.3.1 to PyPi
 Please upload 3.3.1 to PyPi! 

The latest version in PyPi is 3.3.0 and it is completely broken. It won't event start.

ASAP

What is the state on this? I would really really love to have it 😄 

done https://pypi.org/project/django-celery/3.3.1/

please consider donating to celery on tidelift / open collective

Thank you so much, would definitely consider on contributing to this useful project! 

also please try celery 4.4.0rc3

It is not possible to try that celery version alongside this library because of the required dependencies here (celery>
this is celery 3.x only

Understood, thanks again for your quick help 👍 

 dropped EOL python3 versions
 
 Foolproof prevention via strict tuples. Fixes #573
 In 3.3.0 [options were broken](5d1ecb09c6304d22cc447c7c08fba0bd1febc2ef) by messing up tuples and lists
Someone need to fix travis: "InterpreterNotFound: python3.4" and flake8 exited with 1

python34 is EOL. so no issue

 Fixed #560: Type casting preload_options to list.
 Fixed #560 
The build failed with `The command "tox" exited with 1.` during pkg installation process. Any idea?

 Run management command in tox.
 Run the `celery` management command, to detect breakage there.

This should be more exaustive (though I'm not sure which commands will work with the celery config here?), it should be enough to check if the management command fails.

This is to try and detect bugs like #573 

It looks like there have been similar bugs recently in the tracker too.

~~NOTE:  **I can't run tox here to see if this works.**~~

This fails in tox, so seems to be correct.
Hi,
   This fail, but only because the management command is broken.

S

 TypeError: can only concatenate list (not "tuple") to list
 There is an error when start celery workers through manage.py command.

celery 3.1.25
django 1.11.2

```python
(mr) vlad-mbp:mr novarg$ ./manage.py celery worker -P gevent -l DEBUG -Q default,celery,ldapsync_tasks,email_release_tasks
master

Traceback (most recent call last):
  File "./manage.py", line 11, in <module>
    execute_from_command_line(sys.argv)
  File "/Users/novarg/.virtualenvs/mr/lib/python2.7/site-packages/django/core/management/__init__.py", line 363, in execute_from_command_line
    utility.execute()
  File "/Users/novarg/.virtualenvs/mr/lib/python2.7/site-packages/django/core/management/__init__.py", line 355, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/Users/novarg/.virtualenvs/mr/lib/python2.7/site-packages/django/core/management/__init__.py", line 205, in fetch_command
    klass = load_command_class(app_name, subcommand)
  File "/Users/novarg/.virtualenvs/mr/lib/python2.7/site-packages/django/core/management/__init__.py", line 40, in load_command_class
    module = import_module('%s.management.commands.%s' % (app_name, name))
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/importlib/__init__.py", line 37, in import_module
    __import__(name)
  File "/Users/novarg/.virtualenvs/mr/lib/python2.7/site-packages/gevent/builtins.py", line 93, in __import__
    result = _import(*args, **kwargs)
  File "/Users/novarg/.virtualenvs/mr/lib/python2.7/site-packages/djcelery/management/commands/celery.py", line 11, in <module>
    class Command(CeleryCommand):
  File "/Users/novarg/.virtualenvs/mr/lib/python2.7/site-packages/djcelery/management/commands/celery.py", line 23, in Command
    preload_options)
TypeError: can only concatenate list (not "tuple") to list
```

It seems that base.preload_options is tuple while others are lists.
Confirming.

Installing 3.2.2 works as a workaround.

You can trigger it with most options, e.g. `python manage.py celery list bindings`.

Python 3.7.3
django==1.11.21
celery==3.1.26.post2
django-celery==3.3.0
```
python3 manage.py celery --help

Traceback (most recent call last):
  File "manage.py", line 24, in <module>
    execute_from_command_line(sys.argv)
  File "/Users/mmalysh/Development/mining-website/venv/lib/python3.7/site-packages/django/core/management/__init__.py", line 364, in execute_from_command_line
    utility.execute()
  File "/Users/mmalysh/Development/mining-website/venv/lib/python3.7/site-packages/django/core/management/__init__.py", line 356, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/Users/mmalysh/Development/mining-website/venv/lib/python3.7/site-packages/django/core/management/__init__.py", line 206, in fetch_command
    klass = load_command_class(app_name, subcommand)
  File "/Users/mmalysh/Development/mining-website/venv/lib/python3.7/site-packages/django/core/management/__init__.py", line 40, in load_command_class
    module = import_module('%s.management.commands.%s' % (app_name, name))
  File "/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1006, in _gcd_import
  File "<frozen importlib._bootstrap>", line 983, in _find_and_load
  File "<frozen importlib._bootstrap>", line 967, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 677, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/Users/mmalysh/Development/mining-website/venv/lib/python3.7/site-packages/djcelery/management/commands/celery.py", line 11, in <module>
    class Command(CeleryCommand):
  File "/Users/mmalysh/Development/mining-website/venv/lib/python3.7/site-packages/djcelery/management/commands/celery.py", line 23, in Command
    preload_options)
TypeError: can only concatenate list (not "tuple") to list
```
3.2.2 works fine.

Python 3.6.8
django==2.1.10
celery==3.1.26.post2
django-celery==3.3.0

TypeError: can only concatenate list (not "tuple") to list

django-celery 3.2.2 works fine.

Thank you!

Nice elegant solution :) 

That fix also closes https://github.com/celery/django-celery/issues/560 and https://github.com/celery/django-celery/pull/575

> Python 3.7.3
> django==1.11.21
> celery==3.1.26.post2
> django-celery==3.3.0
> 
> ```
> python3 manage.py celery --help
> 
> Traceback (most recent call last):
>   File "manage.py", line 24, in <module>
>     execute_from_command_line(sys.argv)
>   File "/Users/mmalysh/Development/mining-website/venv/lib/python3.7/site-packages/django/core/management/__init__.py", line 364, in execute_from_command_line
>     utility.execute()
>   File "/Users/mmalysh/Development/mining-website/venv/lib/python3.7/site-packages/django/core/management/__init__.py", line 356, in execute
>     self.fetch_command(subcommand).run_from_argv(self.argv)
>   File "/Users/mmalysh/Development/mining-website/venv/lib/python3.7/site-packages/django/core/management/__init__.py", line 206, in fetch_command
>     klass = load_command_class(app_name, subcommand)
>   File "/Users/mmalysh/Development/mining-website/venv/lib/python3.7/site-packages/django/core/management/__init__.py", line 40, in load_command_class
>     module = import_module('%s.management.commands.%s' % (app_name, name))
>   File "/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/importlib/__init__.py", line 127, in import_module
>     return _bootstrap._gcd_import(name[level:], package, level)
>   File "<frozen importlib._bootstrap>", line 1006, in _gcd_import
>   File "<frozen importlib._bootstrap>", line 983, in _find_and_load
>   File "<frozen importlib._bootstrap>", line 967, in _find_and_load_unlocked
>   File "<frozen importlib._bootstrap>", line 677, in _load_unlocked
>   File "<frozen importlib._bootstrap_external>", line 728, in exec_module
>   File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
>   File "/Users/mmalysh/Development/mining-website/venv/lib/python3.7/site-packages/djcelery/management/commands/celery.py", line 11, in <module>
>     class Command(CeleryCommand):
>   File "/Users/mmalysh/Development/mining-website/venv/lib/python3.7/site-packages/djcelery/management/commands/celery.py", line 23, in Command
>     preload_options)
> TypeError: can only concatenate list (not "tuple") to list
> ```
> 
> 3.2.2 works fine.

python3.7 cannot run with celery?

@SUNNYWILLHAPPEN this error not about Python version, you're need django-celery
 Version on pypi looks weird
 Probably not super important, but there are two versions showing on the pypi download page, so I'm not sure which is correct (I think it's 3.2.2)

![image](https://user-images.githubusercontent.com/179677/59502995-314f5780-8e97-11e9-93fa-88a8ec377353.png)

Looks like someone updated the readme but didn't create the git tag...  @auvipy was 3.3.0 an intended new release?  

3.3.0 is the latest version, but on that time readme was forgotten not updated

Thanks for clarifying. 

 Update readme
 
 README fixes
 ![image](https://user-images.githubusercontent.com/26336/59113881-917c5180-890b-11e9-9863-f5a98d0e235e.png)

 Fix bug when run command `celery`
 There's a bug when run `python manage celery` related to attribute `preload_options` not existed in `CeleryCommand`.
@auvipy , it's failed looked like some others. I think it should be fixed somewhere but this PR.

'CeleryCommand' object has no attribute 'preload_options'

flake8 tests are failing now. 

 Django 1.11 to 2.2 support needs Funding
 I am looking for a few sponsors to work on these features:
https://opencollective.com/celery
Would like to contribute as a code contributor on this feature.

> Would like to contribute as a code contributor on this feature.

That's not a sustainable solution IMHO and from previous experience.

@auvipy A fundraiser seems like a good idea.

As it stands, what's currently missing / would be a new feature from Django 1.11/2.2 support?  Is there list / issue thread of stuff that funding would go to?

work on celery 3.x branch for some new releases with numerous bug fix and some new features needed for smoother migration to celery 4.x and Django-celery working with them. in a nutshell

could you plz provide a sponsor link to pay?

https://opencollective.com/celery

@auvipy  Place where we can find the list of bugs/feature needed in Django-celery for celery 3.x for smoother migration to celery 4.x?

I'd be happy to support if you have a description of the project and estimate of the cost.  

can you drop a line? auvipy@gmail.com

Has any head way been made ?  I have some time I could contribute as well.  I am working on an old project using djcelery and would like to update it.

Also happy to chip in if needed.

